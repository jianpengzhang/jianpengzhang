---
title: OpenStack Horizon 主题下载
date: 2017-02-26 15:51:09
tags: 源码
---

### 一、写在前面

这篇文章主要介绍基于OpenStack Mitaka Horizon版本开发的主题Bruce，整个主题开发基本没有修改Horizon原有的任何代码，所有的主题代码都在horizon/openstack_dashboard/themes/bruce目录中，一方面更好的兼容openstack horion以便后续版本升级，另一方面，方便大家学习。
如果转载，请保留作者信息。 
邮箱地址：jpzhang.ht@gmail.com
个人博客：https://jianpengzhang.github.io
CSDN博客：http://blog.csdn.net/u011521019
主题下载地址：https://jianpengzhang.github.io/2017/02/26/2017022603/
{% asset_img p1.png 图1 登录 %}
<!-- more -->
### 二、OpenStack Bruce 主题介绍

####目录结构：
horizon/openstack_dashboard/themes
.
├── bruce
│   ├── static
│   └── templates
├── default
│   ├── bootstrap
│   └── horizon
├── demo
│   ├── help
│   ├── html
│   ├── javascripts
│   ├── patches
│   └── styles
└── material
    ├── static
    └── templates

bruce代码主题包存放在bruce目录中。static目录用来存放所有的静态文件包括CSS、JS等，templates目录存放所有的主题模版。这里不在具体详细的解释开发步骤，

#### Bruce 主题介绍：

1、系统登录界面
{% asset_img p1.png 图1 登录 %}
                        
登录界面下方可以自由切换喜欢的背景图片

2、项目概况
{% asset_img p2.png 图2 项目概况 %}

{% asset_img p3.png 图3 主题切换 %}￼

{% asset_img p4.png 图4 主题配色切换 %}￼

* 登录进来后项目概况页面，左侧导航通过OpenStack 机制自动加载出来，
* 可以根据用户个人习惯，通过单机按钮展开或者缩紧，
* 右侧齿轮样子的图标可以根据喜好西游配置主题颜色风格
* 页面主要显示项目可用配置的使用情况，以及最近的项目操作记录，当然，操作记录这块底层并没有实现，要实现的话简单的方式就是在API 包里面通过装饰器的方式往数据库记录用户操作
* 可以自由在openstack 原生主题切换

3、项目云主机列表
{% asset_img p5.png 图5 项目云主机列表 %}￼

{% asset_img p6.png 图6 项目云主机创建 %}￼

这一块基本保持openstack 原有的样式风格，只不过增加了云主机的介绍相关的信息。

4、云主机详情
{% asset_img p7.png 图7 项目云主机详情 %}￼￼

同样，保持原生样式结构，只不过对一些信息点进行了高粱处理，不过您们有时间可以对这块的内容进行重新排版，当前的样式比较浪费空间。

5、项目云硬盘
{% asset_img p8.png 图8 项目云硬盘列表 %}

6、项目镜像列表
{% asset_img p9.png 图9 项目镜像列表 %}

7、系统概况
{% asset_img p10.png 图10 系统概况 %}

8、系统虚拟机管理器
{% asset_img p11.png 图11 系统虚拟机管理器 %}

其他模块页面基本相识，这里不再一一展开来讲，感兴趣的可以通过以下的方式下载学习。

9、静态模版样式包：

{% asset_img demo01.png 图11 Demo01 %}￼

{% asset_img demo01.png 图11 Demo02 %}

{% asset_img demo01.png 图11 Demo03 %}


### 三、部署
通过下的方式获取代码包，
通过 python manage.py runserver 运行：
vi horizon-bruce/horizon/openstack_dashboard/local/ local_settings.py
```
OPENSTACK_HOST="192.168.31.235"
OPENSTACK_KEYSTONE_URL="http://192.168.31.235:5000/v3"
```
配置您的openstack 控制节点地址，以及keystone地址，如果在同一个节点上地址就是一样的。

重新生成静态文件到/stack 目录下
sudo python manage.py  collectstatic -c  运行时候提示输入 “yes”

压缩静态问价：
sudo python manage.py compress


通过Apache运行：
通过mv 命令备份原先的horizon包，然后把下载下来新的horizon包放到该位置上，修改如下：

vi horizon-bruce/horizon/openstack_dashboard/local/ local_settings.py
```
OPENSTACK_HOST="192.168.31.235"
OPENSTACK_KEYSTONE_URL="http://192.168.31.235:5000/v3"
```
配置您的openstack 控制节点地址，以及keystone地址，如果在同一个节点上地址就是一样的。

重新生成静态文件到/stack 目录下
sudo python manage.py  collectstatic -c  运行时候提示输入 “yes”

压缩静态问价：
sudo python manage.py compress

修改apache配置：
vi /etc/apache2/sites-available/horizon.conf 路径可能有所不一样，应为我这里是devstack起的apache。
主要是将“/dashboard/”修改成“/”根目录
"/dashboard/" ＝》 "/project/"
```
WSGIScriptAlias / /home/devstack.mitaka/horizon/openstack_dashboard/wsgi/django.wsgi
Alias /media /home/devstack.mitaka/horizon/openstack_dashboard/static
Alias /static /home/devstack.mitaka/horizon/static
RedirectMatch "^/$" "/project/"
```
重启apache服务即可

### 四、下载
您的小额赞助，鼓励作者写出更好的主题，让更多的OpenStack开发者、创业公司能够更专注底层虚拟化、存储、网络，不必在担心horizon的优化等。

#### 基本版本下载：
包括上述描述的所有界面功能，但不提供静态主题包，扫一扫下方二维码，完成支付，并把截图发送给QQ：3477447625，将获取百度云下载密码，百度云下载地址：链接: http://pan.baidu.com/s/1slR9lHr
{% asset_img 50.jpg 支付 %}

#### 完整版本下载：
包括基础版所有界面功能，并附加一个静态完整主题包(horizon/openstack_dashboard/themes/demo)，方便您后续按照需求继续完善开发。
扫一扫下方二维码，完成支付，并把截图发送给QQ：3477447625，将获取百度云下载密码，百度云下载地址：链接: http://pan.baidu.com/s/1pLTFhSR
{% asset_img 100.jpg 支付 %}￼


